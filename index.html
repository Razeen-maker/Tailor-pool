<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StitchHub | Professional Tailor Pool</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .hidden { display: none; }
        .active-tab { border-bottom: 4px solid #6366f1; color: #6366f1; }
        input:focus, select:focus { outline: 2px solid #6366f1; }
    </style>
</head>
<body class="bg-gray-100 min-h-screen pb-10">

    <nav class="bg-white shadow-sm sticky top-0 z-50">
        <div class="max-w-md mx-auto flex justify-around text-sm">
            <button onclick="showTab('pool')" id="btn-pool" class="py-4 px-2 font-bold active-tab">THE POOL</button>
            <button onclick="showTab('register')" id="btn-register" class="py-4 px-2 font-bold text-gray-400">JOIN AS TAILOR</button>
            <button onclick="showTab('profile')" id="btn-profile" class="py-4 px-2 font-bold text-gray-400">MY MEASUREMENTS</button>
        </div>
    </nav>

    <div class="max-w-md mx-auto p-4">
        
        <div id="tab-pool">
            <div class="flex justify-between items-center mb-6">
                <h1 class="text-2xl font-black text-gray-800">Find a Tailor</h1>
                <span class="bg-indigo-100 text-indigo-700 text-xs font-bold px-2 py-1 rounded">2026 UPDATED</span>
            </div>
            <div id="tailor-display-list" class="space-y-4">
                <p class="text-center text-gray-400 py-10">Searching the database...</p>
            </div>
        </div>

        <div id="tab-register" class="hidden">
            <h1 class="text-2xl font-black mb-4 text-gray-800">Register Your Studio</h1>
            <div class="bg-white p-6 rounded-2xl shadow-sm border border-gray-200">
                <div class="space-y-4">
                    <div>
                        <label class="block text-xs font-bold uppercase text-gray-500 mb-1">Business Name</label>
                        <input id="reg-name" type="text" class="w-full bg-gray-50 border p-3 rounded-xl" placeholder="e.g. Signature Stitches">
                    </div>
                    <div>
                        <label class="block text-xs font-bold uppercase text-gray-500 mb-1">Specialty</label>
                        <select id="reg-spec" class="w-full bg-gray-50 border p-3 rounded-xl">
                            <option>Men's Formalwear</option>
                            <option>Evening & Bridal</option>
                            <option>Traditional/Ethnic Wear</option>
                            <option>General Alterations</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-xs font-bold uppercase text-gray-500 mb-1">Location / Area</label>
                        <input id="reg-loc" type="text" class="w-full bg-gray-50 border p-3 rounded-xl" placeholder="City or District">
                    </div>
                    <button onclick="submitTailor()" class="w-full bg-indigo-600 text-white font-black py-4 rounded-xl shadow-lg shadow-indigo-200 transition active:scale-95">
                        REQUEST TO JOIN POOL
                    </button>
                </div>
            </div>
        </div>

        <div id="tab-order" class="hidden">
            <button onclick="showTab('pool')" class="text-indigo-600 font-bold mb-4 flex items-center">
                <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M15 19l-7-7 7-7"></path></svg> Back
            </button>
            <h1 class="text-2xl font-black mb-4">Book <span id="target-tailor-name" class="text-indigo-600">Tailor</span></h1>
            
            <div class="bg-white p-6 rounded-2xl shadow-sm space-y-6">
                <div>
                    <h3 class="text-sm font-black text-gray-400 uppercase tracking-widest mb-3">Upper Body (Inches)</h3>
                    <div class="grid grid-cols-2 gap-3">
                        <input type="number" id="m-neck" placeholder="Neck" class="bg-gray-50 border p-3 rounded-xl">
                        <input type="number" id="m-chest" placeholder="Chest/Bust" class="bg-gray-50 border p-3 rounded-xl">
                        <input type="number" id="m-shoulder" placeholder="Shoulder Width" class="bg-gray-50 border p-3 rounded-xl">
                        <input type="number" id="m-sleeve" placeholder="Sleeve Length" class="bg-gray-50 border p-3 rounded-xl">
                    </div>
                </div>

                <div>
                    <h3 class="text-sm font-black text-gray-400 uppercase tracking-widest mb-3">Lower Body (Inches)</h3>
                    <div class="grid grid-cols-2 gap-3">
                        <input type="number" id="m-waist" placeholder="Waist" class="bg-gray-50 border p-3 rounded-xl">
                        <input type="number" id="m-hip" placeholder="Hips" class="bg-gray-50 border p-3 rounded-xl">
                        <input type="number" id="m-inseam" placeholder="Inseam" class="bg-gray-50 border p-3 rounded-xl">
                        <input type="number" id="m-length" placeholder="Full Length" class="bg-gray-50 border p-3 rounded-xl">
                    </div>
                </div>

                <div>
                    <h3 class="text-sm font-black text-gray-400 uppercase tracking-widest mb-3">Design Link</h3>
                    <input type="text" id="m-design" placeholder="Link to style (Pinterest/Imgur)" class="w-full bg-gray-50 border p-3 rounded-xl">
                </div>

                <div class="p-3 bg-amber-50 border border-amber-100 rounded-lg">
                    <p class="text-[10px] text-amber-700 leading-tight">
                        <b>NOTE:</b> By confirming, you agree that measurements are accurate within a 2cm margin. Errors in measurement provided by the customer are not eligible for refunds.
                    </p>
                </div>

                <button onclick="placeOrder()" class="w-full bg-black text-white font-black py-4 rounded-xl active:scale-95 transition">
                    CONFIRM ORDER & PAY
                </button>
            </div>
        </div>

    </div>

    <script>
        // CONFIG: Replace with your SheetDB API URL
        const SHEET_API = "https://sheetdb.io/api/v1/48j2ydxugqj6r";

        function showTab(tab) {
            // Hide all tabs
            ['tab-pool', 'tab-register', 'tab-order'].forEach(id => {
                document.getElementById(id).classList.add('hidden');
            });
            // Reset nav styles
            ['btn-pool', 'btn-register', 'btn-profile'].forEach(id => {
                if(document.getElementById(id)) {
                    document.getElementById(id).classList.remove('active-tab', 'text-indigo-600');
                    document.getElementById(id).classList.add('text-gray-400');
                }
            });

            // Show current tab
            document.getElementById('tab-' + tab).classList.remove('hidden');
            const activeBtn = document.getElementById('btn-' + (tab === 'order' ? 'pool' : tab));
            if(activeBtn) {
                activeBtn.classList.add('active-tab', 'text-indigo-600');
                activeBtn.classList.remove('text-gray-400');
            }

            if(tab === 'pool') loadTailors();
        }

        // FETCH ACTIVE TAILORS
        async function loadTailors() {
            const container = document.getElementById('tailor-display-list');
            try {
                const res = await fetch(SHEET_API);
                const data = await res.json();
                
                // Only show "Active" tailors
                const activeOnes = data.filter(t => t.status.toLowerCase() === 'active');
                
                if(activeOnes.length === 0) {
                    container.innerHTML = `<div class="text-center py-10 text-gray-400">No verified tailors available in the pool yet.</div>`;
                    return;
                }

                container.innerHTML = activeOnes.map(t => `
                    <div class="bg-white p-5 rounded-2xl shadow-sm flex justify-between items-center border border-gray-100">
                        <div>
                            <h2 class="font-black text-gray-800 text-lg">${t.name}</h2>
                            <p class="text-xs font-bold text-indigo-500 uppercase">${t.specialty}</p>
                            <p class="text-xs text-gray-400 mt-1">üìç ${t.location}</p>
                        </div>
                        <button onclick="startOrder('${t.name}')" class="bg-black text-white px-5 py-2 rounded-full text-sm font-black active:scale-90 transition">
                            BOOK
                        </button>
                    </div>
                `).join('');
            } catch (err) {
                container.innerHTML = `<p class="text-red-500 text-center">Error connecting to database. Please check API ID.</p>`;
            }
        }

        // REGISTER NEW TAILOR
        async function submitTailor() {
            const btn = event.target;
            const payload = {
                name: document.getElementById('reg-name').value,
                specialty: document.getElementById('reg-spec').value,
                location: document.getElementById('reg-loc').value,
                status: 'Pending'
            };

            if(!payload.name || !payload.location) return alert("Please fill all fields");

            btn.innerText = "SAYING...";
            btn.disabled = true;

            const res = await fetch(SHEET_API, {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({ data: [payload] })
            });

            if(res.ok) {
                alert("Success! Your studio is submitted for verification.");
                showTab('pool');
            }
            btn.innerText = "REQUEST TO JOIN POOL";
            btn.disabled = false;
        }

        function startOrder(name) {
            document.getElementById('target-tailor-name').innerText = name;
            showTab('order');
            window.scrollTo(0,0);
        }

        function placeOrder() {
            alert("Order generated! In a full production app, this would now redirect to a Payment Gateway (Stripe/PayPal).");
            showTab('pool');
        }

        // Initial Load
        loadTailors();
    </script>
</body>
</html>
